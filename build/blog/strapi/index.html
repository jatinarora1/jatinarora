<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<title data-react-helmet="true">All in one guide for creating a killer API with Strapi | Jatin Arora</title><meta data-react-helmet="true" property="og:title" content="All in one guide for creating a killer API with Strapi | Jatin Arora"><meta data-react-helmet="true" name="description" content="This article was originally published here"><meta data-react-helmet="true" property="og:description" content="This article was originally published here"><meta data-react-helmet="true" property="og:image" content="http://localhost:3000/img/jatin.jpg"><meta data-react-helmet="true" property="twitter:image" content="http://localhost:3000/img/jatin.jpg"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for All in one guide for creating a killer API with Strapi | Jatin Arora"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/jatin.jpg"><link rel="stylesheet" href="/styles.d48d5b3b.css">
<link rel="preload" href="/styles.152560a6.js" as="script">
<link rel="preload" href="/runtime~main.b8677e71.js" as="script">
<link rel="preload" href="/main.48060fb2.js" as="script">
<link rel="preload" href="/1.57e2cf85.js" as="script">
<link rel="preload" href="/2.818658f0.js" as="script">
<link rel="preload" href="/3.d3fc3d6d.js" as="script">
<link rel="preload" href="/ccc49370.2475dd98.js" as="script">
<link rel="preload" href="/28a442c9.f7c50591.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Jatin Arora</strong></a><a class="navbar__item navbar__link" href="/resume">Resume</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/projects">Conributions</a><a href="https://github.com/jatinarora1" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Jatin Arora</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/resume">Resume</a></li><li class="menu__list-item"><a class="menu__link" href="/projects">Conributions</a></li><li class="menu__list-item"><a href="https://github.com/jatinarora1" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">All in one guide for creating a killer API with Strapi</h1><div class="margin-vert--md"><time datetime="2020-05-24T00:00:00.000Z" class="blogPostDate_3bQP">May 24, 2020  ¬∑ 12 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/anshulrgoyal" target="_blank" rel="noreferrer noopener"><img src="/img/anshul.jpg" alt="Anshul Goyal"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/anshulrgoyal" target="_blank" rel="noreferrer noopener">Anshul Goyal</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="this-article-was-originally-published-here"></a>This article was originally published <a href="https://blog.logrocket.com/how-to-create-an-api-with-strapi/" target="_blank" rel="noopener noreferrer">here</a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#this-article-was-originally-published-here" title="Direct link to heading">#</a></h2><p>CMS has been around for quite some time. CMS refers to the content management system. Strapi is a headless CMS for Node.js. Strapi provides GUI for creating different content types and user management baked in the platform. Strapi supports both Restful API and GraphQL. Strapi supports both NoSQL and SQL databases. Changing the database is as simple as changing environment variables.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-the-work-environment"></a>Setting up the work environment<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-up-the-work-environment" title="Direct link to heading">#</a></h1><p>Strapi requires Node.js installed on the system. Node.js can be downloaded from the official website. Strapi provides a boilerplate generator <code>create-strapi-app</code>, for setting up the application. It can be installed globally using npm using the following commands.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ npm i -g create-strapi-app</span></div></div></div></div></div><p>Using <code>create-strapi-app</code> is simple just pass the name of the project. <code>--quickstart</code> will create a project with a default setting.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">create-strapi-app my-blog --quickstart</span></div></div></div></div></div><p>An admin user is required to be created before Strapi can be used. Start the server using <code>npm run develop</code>.It starts the server on <code>http://localhost:1337</code>. Admin user is created using <code>http://localhost:1337/admin/auth/register</code>.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590234211220_image.png" alt="Example for Admin User"></p><p>Once the boiler-plate is ready. Admin UI can be used to build database schema for API.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="backend"></a>Backend<a aria-hidden="true" tabindex="-1" class="hash-link" href="#backend" title="Direct link to heading">#</a></h1><p>Strapi provides easy UI for the creation of database schema. For changing configuration, we have to edit out project files. For example, for changing the <code>env</code> variable we have to edit the <code>config/environments</code> folder.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="creating-database-schema"></a>Creating Database Schema<a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-database-schema" title="Direct link to heading">#</a></h2><p>Strapi includes a content-builder plugin which provides a great UI for creating a database schema. The plugin is independent of the database. The same schema can be used in the SQL and NoSQL databases. The demo website would have a Blog Collection type and Comment Collection type. The blog would store most of the content of different articles. Comment collection will store comments on blog and user information.</p><p><strong>Creating a Collection</strong>
We will start by login into our admin at http://localhost:1337/admin. We now open the Content-Types builder page by clicking on <strong>Content-Types Builder</strong> from the sidebar.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590245355602_image.png"></p><p>Now create a new collection named ‚ÄúBlog‚Äù. This would store blogs for the site. It would have the title, image, and content.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590245980107_image.png"></p><p>Now we would create a collection named ‚ÄúComment‚Äù. This would store comments for the blog. It would have content, user, blog. <code>blog</code> field store the link to the blog on which comment was created and user store details about the user who created it.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590246246530_image.png"></p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590246377435_image.png"></p><p>We have created links from comments, one to user collection, and other to blog collection. Blog collection and user collection don‚Äôt have information about the link. Now our backend is all set.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="documentation-plugin"></a>Documentation Plugin<a aria-hidden="true" tabindex="-1" class="hash-link" href="#documentation-plugin" title="Direct link to heading">#</a></h2><p>We would install documentation-plugin from the ‚ÄúMarketplace‚Äù section for easy access to API details. This plugin would create the swagger specification for the API.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590473880995_image.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="authentication"></a>Authentication<a aria-hidden="true" tabindex="-1" class="hash-link" href="#authentication" title="Direct link to heading">#</a></h2><p>Authentication is a very important aspect of any application. Strapi has JWT based authentication out of the box. A default key is used for signing JWT. Signing key can be changed in the configuration file <code>/extensions/users-permissions/config/jwt.json</code>. API for user signup and login is already baked in the platform.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;jwtSecret&quot;: &quot;f1b4e23e-480b-4e58-923e-b759a593c2e0&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><p>We will use the <code>local</code> provider for authentication. This password and email/username are used for authenticating a user. If we open ‚ÄúDocumentation‚Äù from the Sidebar, it will provide an option to see the swagger API documentation.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590474793994_image.png"></p><p>We click on ‚ÄúOpen the Documentation‚Äù to view swagger API Documentation. If we navigate to ‚ÄúUsersPermissions- User‚Äù we can see there are API to create a user and login user.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590475203429_image.png"></p><p>We will use <code>/auth/local</code> and <code>/auth/local/register</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-permission"></a>Setting Up Permission<a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-up-permission" title="Direct link to heading">#</a></h2><p>Strapi has two roles by default. These roles are used to control access to content.</p><ol><li>Public role is for an unauthenticated user</li><li>Authenticated is for an authenticated user.</li></ol><p>These roles are automatically assigned to a user based on authentication status. We would allow ‚ÄúPublic‚Äù users to read blogs and comments and ‚ÄúAuthenticated‚Äù users can comment on the blog and edit comments. Roles can be edited in the ‚ÄúRoles and Permission‚Äù section.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590485724497_image.png"></p><p>Edit public Roles to allow access to Blogs and Comments</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590486276961_image.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="adding-comments"></a>Adding Comments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-comments" title="Direct link to heading">#</a></h2><p>Now let us add comments to our demo website. For adding comments a user must be authenticated. We need to control write access to comment collection by customizing controller for ‚ÄúComment‚Äù collection. The controller for every collection is located in the <code>api</code> folder. For changing controller edit file <code>api/comment/controllers/comment.js</code>.</p><p>We need to install <code>strapi-util</code>s for editing our controller.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">npm i strapi-utils</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">// file: api/comment/controllers/comment.js</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">const { sanitizeEntity } = require(&#x27;strapi-utils&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">module.exports = {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // this method is called when api to create comment is called</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    async create(ctx) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // add user from the request and add it to the body of request</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        ctx.request.body.user = ctx.state.user.id;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // call the function to creating comment with data</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        let entity = await strapi.services.comment.create(ctx.request.body);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // return data for api after removing field which are not exported</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return sanitizeEntity(entity, { model: strapi.models.comment });</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    async update(ctx) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // get the id of comment which is updated</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        const { id } = ctx.params;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // finding the comment for user and id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        const [comment] = await strapi.services.comment.find({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            id: ctx.params.id,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &#x27;user.id&#x27;: ctx.state.user.id,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        });</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // comment does not exist send error</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (!comment) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return ctx.unauthorized(`You can&#x27;t update this entry`);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // update the comment</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        let entity = await strapi.services.comment.update({ id }, ctx.request.body);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">         // return data for api after removing field which are not exported</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return sanitizeEntity(entity, { model: strapi.models.comment });</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    async delete(ctx) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // get the id of comment which is updated</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        const { id } = ctx.params;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // finding the comment for user and id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        const [comment] = await strapi.services.comment.find({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            id: ctx.params.id,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &#x27;user.id&#x27;: ctx.state.user.id,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        });</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // comment does not exist send error</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (!comment) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return ctx.unauthorized(`You can&#x27;t update this entry`);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // delete the comment</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        let entity = await strapi.services.comment.delete({ id });</span></div><div class="token-line" style="color:#393A34"><span class="token plain">         // return data for api after removing field which are not exported</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return sanitizeEntity(entity, { model: strapi.models.comment });</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">};</span></div></div></div></div></div><p>We just add an extra layer over the function provided by strapi, so that we can add user data to the request body, and rest is handled by strapi. Now we need to change the ‚ÄúAuthenticated‚Äù user role so that users can create, edit, and delete comments.</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590587444113_image.png"></p><p>We give a user permission to create, delete, edit comments.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="frontend"></a>Frontend<a aria-hidden="true" tabindex="-1" class="hash-link" href="#frontend" title="Direct link to heading">#</a></h1><p>For the frontend, we will use Gatsbyjs. We would create a new gatsby project using <code>gatsby new frontend</code>. File structure for our project is:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">src/</span></div><div class="token-line" style="color:#393A34"><span class="token plain">‚îú‚îÄ‚îÄ components</span></div><div class="token-line" style="color:#393A34"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ card.js</span></div><div class="token-line" style="color:#393A34"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ dialog.js</span></div><div class="token-line" style="color:#393A34"><span class="token plain">‚îú‚îÄ‚îÄ images</span></div><div class="token-line" style="color:#393A34"><span class="token plain">‚îî‚îÄ‚îÄ pages</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ‚îú‚îÄ‚îÄ 404.js</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ‚îú‚îÄ‚îÄ blog.js</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ‚îî‚îÄ‚îÄ index.js</span></div></div></div></div></div><p><strong>Different Compoments</strong></p><ul><li>card.js contains a simple card component that displays information provided to it as props.</li><li>dialog.js contains a dialog for sign in and signup.</li><li>blog.js is used to display blogs and comments.</li><li>index.js is the homepage, it display list of blogs</li><li>404.js shows URL not found.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="homepage"></a>Homepage<a aria-hidden="true" tabindex="-1" class="hash-link" href="#homepage" title="Direct link to heading">#</a></h2><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834989946_image.png"></p><p>We make a GET request to API <code>/blogs</code> to fetch all the blogs. Then it maps over a list of blogs and displays Card component for each blog. It also contains code for displaying login/register dialog. When the user clicks on a Card it navigates them to <code>/blog</code> page.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">import React, { useState } from &#x27;react&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import { makeStyles } from &#x27;@material-ui/core/styles&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Grid from &#x27;@material-ui/core/Grid&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Typography from &#x27;@material-ui/core/Typography&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Card from &quot;../components/card&quot;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Dialog from &quot;../components/dialog&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import { Button } from &#x27;@material-ui/core&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">const useStyles = makeStyles((theme) =&gt; ({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  root: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    flexGrow: 1,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    textAlign: &quot;center&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  paper: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    height: 500,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    width: 400,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  control: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    padding: theme.spacing(2),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}));</span></div><div class="token-line" style="color:#393A34"><span class="token plain">export default function () {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  const classes = useStyles();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  const [blogs, setBlogs] = useState([])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  const [open, setOpen] = useState(false)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  const [login, setLogin] = useState(false)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  // fetch all blogs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  React.useEffect(() =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    fetch(&quot;http://localhost:1337/blogs&quot;).then(res =&gt; res.json()).then(val =&gt; setBlogs(val))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }, [])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  return (</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &lt;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    {/*dialog for authentication */}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &lt;Dialog open={open} setOpen={setOpen} login={login} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &lt;Grid container className={classes.root} spacing={2}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;Grid item xs={12}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;Grid container justify=&quot;center&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;Grid item xs={10}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &lt;Typography variant=&quot;h3&quot; component=&quot;h2&quot; gutterBottom gutterLeft&gt;Blogs&lt;/Typography&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            {/*check if token is present or not */}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              !localStorage.getItem(&quot;token&quot;) ? [&lt;Grid item xs={1}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Button onClick={() =&gt; { setOpen(true); setLogin(true) }}&gt;Login&lt;/Button&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &lt;/Grid&gt;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &lt;Grid item xs={1}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Button onClick={() =&gt; { setOpen(true); setLogin(false) }}&gt; Register&lt;/Button&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &lt;/Grid&gt;] : &quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;Grid item xs={12}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;Grid container justify=&quot;center&quot; spacing={10}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            {/*map through list of blog and create list of cards */}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            {blogs.map((value) =&gt; (</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &lt;Grid key={value} item&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Card value={value} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            ))}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &lt;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><p>Card Component</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834819604_image.png"></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">import React from &#x27;react&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import { makeStyles } from &#x27;@material-ui/core/styles&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Card from &#x27;@material-ui/core/Card&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import CardHeader from &#x27;@material-ui/core/CardHeader&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import CardMedia from &#x27;@material-ui/core/CardMedia&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import CardContent from &#x27;@material-ui/core/CardContent&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import CardActions from &#x27;@material-ui/core/CardActions&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Collapse from &#x27;@material-ui/core/Collapse&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Typography from &#x27;@material-ui/core/Typography&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import { red } from &#x27;@material-ui/core/colors&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import { Link } from &#x27;gatsby&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">const useStyles = makeStyles((theme) =&gt; ({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  root: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    maxWidth: 345,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  media: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    height: 0,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    paddingTop: &#x27;56.25%&#x27;, // 16:9</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  expand: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transform: &#x27;rotate(0deg)&#x27;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    marginLeft: &#x27;auto&#x27;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transition: theme.transitions.create(&#x27;transform&#x27;, {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      duration: theme.transitions.duration.shortest,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  expandOpen: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transform: &#x27;rotate(180deg)&#x27;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  avatar: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    backgroundColor: red[500],</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}));</span></div><div class="token-line" style="color:#393A34"><span class="token plain">export default function NewCard({ value }) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  const classes = useStyles();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  return (</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &lt;Link to={`/blog`} state={{ value }}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &lt;Card className={classes.root}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;CardHeader</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          subheader={`Published On ${new Date(value.created_at).toLocaleDateString(&quot;in&quot;)}`}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;CardMedia</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          className={classes.media}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          image={&quot;http://localhost:1337&quot; + value.image.url}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;CardContent&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;Typography variant=&quot;body2&quot; color=&quot;textSecondary&quot; component=&quot;p&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            {value.title}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;/Typography&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;/CardContent&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &lt;/Card&gt;&lt;/Link&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><p>Dialog Component</p><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834887038_image.png"></p><p>We make a POST request to <code>/auth/local/register</code> for user signup with a username, email, and password. When a register is successful, a JWT token is returned which is saved in local storage and can be used later. For log in we make a POST request to <code>/auth/local</code> with two fields <code>identifier</code> and <code>password</code>. <code>identifier</code> can be email or username.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">import React, { useState } from &#x27;react&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Button from &#x27;@material-ui/core/Button&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import TextField from &#x27;@material-ui/core/TextField&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Dialog from &#x27;@material-ui/core/Dialog&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import DialogActions from &#x27;@material-ui/core/DialogActions&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import DialogContent from &#x27;@material-ui/core/DialogContent&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import DialogContentText from &#x27;@material-ui/core/DialogContentText&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import DialogTitle from &#x27;@material-ui/core/DialogTitle&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">export default function FormDialog({ open, setOpen, login }) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const [pass, setPass] = useState(&quot;&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const [email, setEmail] = useState(&quot;&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const [user, setUser] = useState(&quot;&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const handleSubmit = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (!login)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            fetch(&quot;http://localhost:1337/auth/local/register&quot;, {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                method: &quot;post&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                headers: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &quot;content-type&quot;: &quot;application/json&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                body: JSON.stringify({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    password: pass,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    email,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    username: user</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                })</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }).then((res) =&gt; res.json())</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                .then(res =&gt; localStorage.setItem(&quot;token&quot;, res.jwt)).finally(() =&gt; setOpen(false))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        else</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            fetch(&quot;http://localhost:1337/auth/local&quot;, {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                method: &quot;post&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                headers: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &quot;content-type&quot;: &quot;application/json&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                body: JSON.stringify({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    password: pass,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    identifier: user || email</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                })</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }).then((res) =&gt; res.json())</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                .then(res =&gt; localStorage.setItem(&quot;token&quot;, res.jwt)).finally(() =&gt; setOpen(false))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    };</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const handleClose = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        setOpen(false);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    };</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return (</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;div&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;Dialog open={open} onClose={handleClose} aria-labelledby=&quot;form-dialog-title&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;DialogTitle id=&quot;form-dialog-title&quot;&gt;{login ? &quot;Login&quot; : &quot;Register&quot;}&lt;/DialogTitle&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;DialogContent&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;DialogContentText&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        Please provide details</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;/DialogContentText&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;TextField</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        autoFocus</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        margin=&quot;dense&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        id=&quot;email&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        label=&quot;Email Address&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        type=&quot;email&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        fullWidth</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        value={email}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        onChange={(e) =&gt; { setEmail(e.target.value) }}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;TextField</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        autoFocus</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        margin=&quot;dense&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        id=&quot;username&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        label=&quot;Username&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        type=&quot;email&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        fullWidth</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        value={user}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        onChange={(e) =&gt; { setUser(e.target.value) }}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;TextField</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        autoFocus</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        margin=&quot;dense&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        id=&quot;password&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        label=&quot;Password&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        type=&quot;password&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        fullWidth</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        value={pass}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        onChange={(e) =&gt; { setPass(e.target.value) }}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;/DialogContent&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;DialogActions&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;Button onClick={handleClose} color=&quot;primary&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        Cancel</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;/Button&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;Button onClick={handleSubmit} color=&quot;primary&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        Submit</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          &lt;/Button&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;/DialogActions&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;/Dialog&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;/div&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="blog-page"></a>Blog Page<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blog-page" title="Direct link to heading">#</a></h2><p><img src="https://paper-attachments.dropbox.com/s_CC88355492B2A98EAA40B097B1643DA8AE3D35CE509F7D881364ACA0FE320D6E_1590834917875_image.png"></p><p>We will take the details of the blog from the location prop passed to the page. We will fetch comments for the blog using a GET request to <code>/comments?blog={{blog-id}}</code> <code>blog-id</code> is the id of the current blog. We make a POST request to <code>/comments</code> with JWT token in the header. This token is saved in the local storage.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">import React, { useState, useEffect } from &#x27;react&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import { makeStyles } from &#x27;@material-ui/core/styles&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Grid from &#x27;@material-ui/core/Grid&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Typography from &#x27;@material-ui/core/Typography&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import List from &#x27;@material-ui/core/List&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import ListItem from &#x27;@material-ui/core/ListItem&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import ListItemIcon from &#x27;@material-ui/core/ListItemIcon&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import ListItemText from &#x27;@material-ui/core/ListItemText&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Avatar from &#x27;@material-ui/core/Avatar&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import { TextareaAutosize } from &#x27;@material-ui/core&#x27;;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">import Button from &quot;@material-ui/core/Button&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">const useStyles = makeStyles((theme) =&gt; ({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    root: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        flexGrow: 1,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        textAlign: &quot;center&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    paper: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        height: 500,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        width: 400,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    control: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        padding: theme.spacing(2),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    content: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        margin: &quot;100px&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}));</span></div><div class="token-line" style="color:#393A34"><span class="token plain">export default function ({ location }) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const classes = useStyles();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const [comments, setComments] = useState([])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const [content, setContent] = useState(&quot;&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    useEffect(() =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        fetch(`http://localhost:1337/comments?blog=${location.state.value.id}`).then(res =&gt; res.json()).then(val =&gt; setComments(val))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }, [])</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    const submitComment = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        fetch(&quot;http://localhost:1337/comments&quot;, {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            method: &quot;post&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            headers: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &quot;content-type&quot;: &quot;application/json&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                authorization: `Bearer ${localStorage.getItem(&quot;token&quot;)}`</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            body: JSON.stringify({</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                content,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                blog: location.state.value.id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            })</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }).then(() =&gt; fetch(`http://localhost:1337/comments?blog=${location.state.value.id}`).then(res =&gt; res.json()).then(val =&gt; setComments(val)))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return (</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;Grid container className={classes.root} spacing={2}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Grid item xs={12}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;Grid container justify=&quot;center&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        &lt;Grid item xs={10}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            &lt;Typography variant=&quot;h3&quot; component=&quot;h2&quot; gutterBottom gutterLeft&gt;{location.state.value.title}&lt;/Typography&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Grid container justify=&quot;center&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;img src={&quot;http://localhost:1337&quot; + location.state.value.image.url}&gt;&lt;/img&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Grid item xs={12} className={classes.content}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;Grid container justify=&quot;center&quot; spacing={10}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        {location.state.value.content}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Typography variant=&quot;h4&quot; component=&quot;h2&quot; gutterBottom gutterLeft&gt;Comments&lt;/Typography&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Grid item xs={12}&gt;&lt;TextareaAutosize minLength={10} rowsMin={10} style={{ width: &quot;100%&quot; }} value={content} onChange={(e) =&gt; setContent(e.target.value)} /&gt;&lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Grid item xs={12}&gt;&lt;Button onClick={submitComment}&gt;Submit comment&lt;/Button&gt;&lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;Grid item xs={12}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;Grid container justify=&quot;left&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        &lt;List&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                comments.map((val) =&gt; &lt;ListItem&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                    &lt;ListItemIcon&gt;&lt;Avatar&gt;{val.user.username[0]}&lt;/Avatar&gt;&lt;/ListItemIcon&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                    &lt;ListItemText primary={`${val.user.username} said  `} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                    &lt;ListItemText secondary={&quot;: &quot; + val.content} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                &lt;/ListItem&gt;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        &lt;/List&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            &lt;/Grid&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &lt;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    );</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="database"></a>Database<a aria-hidden="true" tabindex="-1" class="hash-link" href="#database" title="Direct link to heading">#</a></h1><p>Strapi support both NoSQL and SQL database. Changing the database is as simple as changing the env variable in the configuration folder. By default, Strapi uses SQLite which is good for local testing but in production one should use a production-ready database like PostgresSQL or MySQL. We will use PostgreSQL. For changing the database we will edit <code>config/environments/production/database.json</code> file.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;defaultConnection&quot;: &quot;default&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  &quot;connections&quot;: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;default&quot;: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &quot;connector&quot;: &quot;bookshelf&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &quot;settings&quot;: {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;client&quot;: &quot;postgres&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;host&quot;: &quot;${process.env.DATABASE_HOST }&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;port&quot;: &quot;${process.env.DATABASE_PORT }&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;database&quot;: &quot;${process.env.DATABASE_NAME }&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;username&quot;: &quot;${process.env.DATABASE_USERNAME }&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;password&quot;: &quot;${process.env.DATABASE_PASSWORD }&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      },</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      &quot;options&quot;: {}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><p>Now it will pick database credentials from the environment variable in production.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="conclusion"></a>Conclusion<a aria-hidden="true" tabindex="-1" class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h1><p>We have gone through some of basic of Strapi. Strapi is great for creating a backend API. It is very customizable and supports a wide array of integration. Strapi can be used with Nuxtjs, Reactjs, Angular any frontend framework. We learned how to create database schema with relations, authentication, customizing controllers, and filtering data.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/strapi">strapi</a><a class="margin-horiz--sm" href="/blog/tags/nodejs">nodejs</a><a class="margin-horiz--sm" href="/blog/tags/cms">cms</a><a class="margin-horiz--sm" href="/blog/tags/backend">backend</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/grpc-rust"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">A beginners guide to gRPC with Rust ¬ª</div></a></div></nav></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/resume">Resume</a></li><li class="footer__item"><a class="footer__link-item" href="/projects">Contributions</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://dev.to/jatinarora1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dev.to</a></li><li class="footer__item"><a href="https://medium.com/@arora8331" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium</a></li><li class="footer__item"><a href="https://www.linkedin.com/in/jatin-a-5a3286137/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin</a></li><li class="footer__item"><a href="https://twitter.com/JATINAR27664823" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/anshulrgoyal" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright ¬© 2020 Jatin Arora.</div></div></div></footer></div>
<script src="/styles.152560a6.js"></script>
<script src="/runtime~main.b8677e71.js"></script>
<script src="/main.48060fb2.js"></script>
<script src="/1.57e2cf85.js"></script>
<script src="/2.818658f0.js"></script>
<script src="/3.d3fc3d6d.js"></script>
<script src="/ccc49370.2475dd98.js"></script>
<script src="/28a442c9.f7c50591.js"></script>
</body>
</html>